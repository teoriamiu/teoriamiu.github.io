<!DOCTYPE html>
<html lang="es" class="dark">

<head>
  <title>Calculadora Nutricional con % VDR</title>
  <meta name="description" content="Calculadora de nutrientes basada en datos del USDA. Calcula macros, vitaminas y minerales con % del valor diario recomendado.">

  <!-- ✅ Etiqueta canónica correcta -->
  <link rel="canonical" href="https://calculadoranutricional.com/">

  <link rel="icon" href="https://play-lh.googleusercontent.com/3NcjaM920fIR1X_ZJ7cm_AWpv3J7dGJCKMxeS7h__p-Zq4xshFAeK_DIFDwtSP0J3dc=w950-h950">
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WQBSBXCBZG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-WQBSBXCBZG');
</script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          animation: {
            fadeInUp: 'fadeInUp 0.8s ease-out both',
          },
          keyframes: {
            fadeInUp: {
              '0%': { opacity: 0, transform: 'translateY(20px)' },
              '100%': { opacity: 1, transform: 'translateY(0)' },
            },
          }
        }
      }
    };
  </script>

  <style>
    html {
      scroll-behavior: smooth;
    }
    
    section:target {
      outline: 2px dashed #6366f1;
      outline-offset: 4px;
    }
    
    /* Animaciones extendidas */
    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }
      
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .animate-fadeInUp {
      animation: fadeInUp 0.8s ease-out both;
    }
    
    html,
    body {
      margin: 0;
      padding: 0;
      scroll-behavior: smooth;
      overflow-x: hidden;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom, #0f172a, #1e3a8a);
      color: white;
    }
    
    /* --- FONDO DINÁMICO PARALLAX CON BANDERA --- */
    body {
  background-image: url('https://play-lh.googleusercontent.com/3NcjaM920fIR1X_ZJ7cm_AWpv3J7dGJCKMxeS7h__p-Zq4xshFAeK_DIFDwtSP0J3dc=w950-h950');
  background-size: cover;              /* Ocupa toda la pantalla sin distorsionar */
  background-position: center;         /* Centra la imagen */
  background-repeat: no-repeat;        /* Evita repeticiones */
  background-attachment: fixed;        /* Hace que quede fija al hacer scroll */
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', sans-serif;
  color: white;
}
    
    /* --- ENCABEZADO --- */
    header {
      background: linear-gradient(to right, #1e3a8a, #dc2626);
      padding: 1rem;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      text-shadow: 2px 2px 5px #000;
      letter-spacing: 2px;
      border-bottom: 2px solid white;
    }
    
    /* --- MAIN CONTAINER --- */
    main {
      max-width: 1000px;
      margin: 3rem auto;
      background: rgba(0, 0, 0, 0.1);
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 0 25px rgba(255, 255, 255, 0.15);
      animation: fadeInUp 1s ease-out both;
    }
    
    /* --- TITULOS Y SECCIONES --- */
    h1,
    h2,
    h3 {
      color: white;
      text-shadow: 1px 1px 5px #1e3a8a;
      margin-bottom: 1rem;
    }
    
    section {
      padding: 2rem 0;
      border-top: 2px dashed #ffffff22;
    }
    
    /* --- INPUTS Y BOTONES --- */
    input {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid #fff;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      color: white;
      margin-right: 0.5rem;
      transition: 0.3s;
    }
    
    input:focus {
      outline: none;
      border-color: #3b82f6;
      background-color: rgba(255, 255, 255, 0.2);
    }
    
    button {
      padding: 0.6rem 1.2rem;
      margin-right: 0.5rem;
      border: none;
      border-radius: 0.6rem;
      font-weight: bold;
      cursor: pointer;
      color: white;
      transition: all 0.3s ease-in-out;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    /* ESTILO PATRIÓTICO PARA BOTONES */
    .btn-patriot-blue {
      background: linear-gradient(to right, #1e3a8a, #3b82f6);
    }
    
    .btn-patriot-red {
      background: linear-gradient(to right, #991b1b, #ef4444);
    }
    
    .btn-patriot-white {
      background: linear-gradient(to right, #f9fafb, #e5e7eb);
      color: #111827 !important;
    }
    
    button:hover {
      transform: translateY(-2px);
      opacity: 0.9;
    }
    
    /* --- TABLA --- */
    table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(255, 255, 255, 0.05);
      margin-top: 1.5rem;
      border: 1px solid #ffffff33;
      border-radius: 0.5rem;
      overflow: hidden;
    }
    
    th,
    td {
      padding: 0.75rem;
      border: 1px solid #ffffff22;
      text-align: left;
      word-break: break-word;
    }
    
    th {
      background: #1e3a8a;
    }
    
    .category td {
      background: #dc2626cc;
      font-weight: bold;
    }
    
    /* --- FOOTER --- */
    footer {
      text-align: center;
      padding: 1.5rem;
      margin-top: 3rem;
      background-color: #1e3a8a;
      font-size: 1rem;
      color: white;
      border-top: 2px solid white;
    }
    
    /* --- ANIMACIONES --- */
    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(20px);
      }
      
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* --- LISTAS Y ESPACIADOS --- */
    ul {
      list-style: disc;
      padding-left: 1.5rem;
    }
    
    #resultados {
      margin-top: 1rem;
    }
    
    /* --- RESPONSIVE --- */
    @media (max-width: 600px) {

      input,
      button {
        width: 100%;
        margin-bottom: 1rem;
      }
      
      button {
        margin-right: 0;
      }
    }
    
    #sugerencias div {
      background: linear-gradient(to right, #1e3a8a, #dc2626);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      gap: 0.75rem;
      transition: 0.2s;
    }
    
    #sugerencias div:hover {
      background: linear-gradient(to right, #3b82f6, #ef4444);
      transform: scale(1.02);
    }
    
    #sugerencias img {
      width: 20px;
      height: auto;
    }
    
    footer p {
      font-style: italic;
      font-size: 0.875rem;
      text-shadow: 1px 1px 3px #000;
      letter-spacing: 0.05em;
    }
    
    footer a {
      text-decoration: underline;
      transition: color 0.3s ease;
    }
  </style>
  
</head>


<main class="max-w-6xl mx-auto px-4 py-16 space-y-24">
  
  <section id="calculadora-nutricional" class="space-y-6">
    <h1 class="text-2xl font-bold text-center">Nutritional Calculator with % VDR</h1>
    <input type="text" id="search" placeholder="search for food (ex: egg raw)" class="p-2 border rounded-md" />
    <input type="number" id="grams" value="100" min="1" class="p-2 border rounded-md" /> g
    <button onclick="buscar()" class="btn-patriot-blue text-white px-6 py-2 rounded font-semibold">Search</button>
    <div id="sugerencias" class="mt-2 space-y-2"></div>
    <button onclick="limpiarTodo()" class="btn-patriot-red text-white px-6 py-2 rounded font-semibold">Clear</button>
    <button onclick="copiarResultados()" class="btn-patriot-white px-6 py-2 rounded font-semibold">Share</button>
    
    <div id="resultados" class="mt-4"></div>
    
    <h3 class="text-xl font-semibold mt-6">Selected foods</h3>
    <ul id="listaAlimentos" class="list-disc pl-6"></ul>
    
    <h2 class="text-xl font-semibold mt-6">Nutrients found</h2>
    <table id="tabla" class="text-white bg-black bg-opacity-60 rounded-xl border border-white text-sm">
      
      <thead>
        <tr>
          <th class="px-4 py-2 text-left">Nutrient</th>
          <th class="px-4 py-2 text-left">Amount</th>
          <th class="px-4 py-2 text-left">Unit</th>
          <th class="px-4 py-2 text-left">% VDR</th>
          
          
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <div class="mt-6 p-4 bg-black bg-opacity-60 rounded-lg shadow-inner text-white text-sm text-center">
      Data provided by
      <a href="https://fdc.nal.usda.gov/" target="_blank" class="px-4 py-2">
        USDA FoodData Central
      </a>
    </div>
  </section>
  
  
</main>



<script>
  // Funciones de la calculadora nutricional
  function buscar() {
    // Función de búsqueda para encontrar alimento y mostrar sus nutrientes
  }
  
  function limpiarTodo() {
    // Limpiar todo el contenido de los resultados y la lista de alimentos
  }
  
  function copiarResultados() {
    // Función para copiar los resultados de nutrientes
  }
</script>


</body>

</html>
<script>
  const valoresDiarios = {
    // Macronutrientes + bioactivos
    "Energy (kcal)": 2000,
    "Energy (kJ)": 8374, // 2000 kcal × 4.187
    "Protein": 50,
    "Carbohydrate, by difference": 275,
    "Starch": null,
    "Cholesterol": 300,
    "Caffeine": 400,
    "Theobromine": null,
    "Phytosterols": null,
    "Water": null,
    "Alcohol, ethyl": 0,
    "Total lipid (fat)": 78,
    "Fiber, total dietary": 28,
    
    // Minerales
    "Ash": null,
    "Calcium, Ca": 1300,
    "Phosphorus, P": 1250,
    "Magnesium, Mg": 420,
    "Sodium, Na": 2300,
    "Potassium, K": 4700,
    "Chloride": 2300,
    "Iron, Fe": 18,
    "Zinc, Zn": 11,
    "Copper, Cu": 0.9,
    "Manganese, Mn": 2.3,
    "Selenium, Se": 55,
    "Chromium, Cr": 35,
    "Iodine, I": 150,
    "Molybdenum, Mo": 45,
    "Fluoride, F": 4,
    
    // Vitaminas liposolubles
    "Vitamin A, IU": 5000,
    "Vitamin A, RAE": 900,
    "Retinol": null,
    "Carotene, beta": null,
    "Carotene, alpha": null,
    "Lycopene": null,
    "Vitamin D (D2 + D3), International Units": 800,
    "Vitamin D (D2 + D3)": 20,
    "Vitamin D3 (cholecalciferol)": null,
    "Vitamin E (alpha-tocopherol)": 15,
    "Vitamin E, added": null,
    "Tocopherol, beta": null,
    "Tocopherol, gamma": null,
    "Tocopherol, delta": null,
    "Tocotrienol, alpha": null,
    "Tocotrienol, beta": null,
    "Tocotrienol, gamma": null,
    "Tocotrienol, delta": null,
    "Vitamin K (phylloquinone)": 120,
    "Vitamin K (Menaquinone-4)": null,
    "Cryptoxanthin, beta": null,
    "Lutein + zeaxanthin": null,
    
    // Vitaminas hidrosolubles
    "Vitamin C, total ascorbic acid": 90,
    "Thiamin": 1.2,
    "Riboflavin": 1.3,
    "Niacin": 16,
    "Vitamin B-6": 1.7,
    "Folate, total": 400,
    "Folic acid": 400,
    "Folate, food": null,
    "Folate, DFE": 400,
    "Vitamin B-12": 2.4,
    "Vitamin B-12, added": 2.4,
    "Biotin": 30,
    "Pantothenic acid": 5,
    "Choline, total": 550,
    "Betaine": null,
    
    // Azúcares simples
    "Sucrose": null,
    "Glucose": null,
    "Fructose": null,
    "Lactose": null,
    "Maltose": null,
    "Galactose": null,
    "Total Sugars": 50,
    
    // Aminoácidos esenciales
    "Histidine": null,
    "Isoleucine": null,
    "Leucine": null,
    "Lysine": null,
    "Methionine": null,
    "Phenylalanine": null,
    "Threonine": null,
    "Tryptophan": null,
    "Valine": null,
    
    // Aminoácidos no esenciales
    "Alanine": null,
    "Arginine": null,
    "Aspartic acid": null,
    "Cysteine": null,
    "Glutamic acid": null,
    "Glutamine": null,
    "Glycine": null,
    "Ornithine": null,
    "Proline": null,
    "Serine": null,
    "Tyrosine": null,
    "Citrulline": null,
    
    // Grasas saturadas
    "SFA 4:0": null,
    "SFA 6:0": null,
    "SFA 8:0": null,
    "SFA 10:0": null,
    "SFA 12:0": null,
    "SFA 14:0": null,
    "SFA 15:0": null,
    "SFA 16:0": null,
    "SFA 17:0": null,
    "SFA 18:0": null,
    "SFA 20:0": null,
    "SFA 22:0": null,
    "SFA 24:0": null,
    "Fatty acids, total saturated": 20,
    
    // Grasas monoinsaturadas
    "MUFA 14:1": null,
    "MUFA 15:1": null,
    "MUFA 16:1": null,
    "MUFA 16:1 c": null,
    "MUFA 17:1": null,
    "MUFA 18:1": null,
    "MUFA 18:1 c": null,
    "MUFA 20:1": null,
    "MUFA 22:1": null,
    "MUFA 22:1 c": null,
    "MUFA 24:1 c": null,
    "Fatty acids, total monounsaturated": null,
    
    // Grasas poliinsaturadas
    "PUFA 18:2": null,
    "PUFA 18:2 n-6 c,c": null,
    "PUFA 18:2 CLAs": null,
    "PUFA 18:3": null,
    "PUFA 18:3 n-3 c,c,c (ALA)": 1.6,
    "PUFA 18:3 n-6 c,c,c": null,
    "PUFA 18:4": null,
    "PUFA 20:2 n-6 c,c": null,
    "PUFA 20:3": null,
    "PUFA 20:3 n-3": null,
    "PUFA 20:3 n-6": null,
    "PUFA 20:4": null,
    "PUFA 20:5 n-3 (EPA)": null,
    "PUFA 22:4": null,
    "PUFA 22:5 n-3 (DPA)": null,
    "PUFA 22:6 n-3 (DHA)": null,
    "Fatty acids, total polyunsaturated": null,
    
    // Grasas trans
    "TFA 16:1 t": null,
    "TFA 18:1 t": null,
    "TFA 22:1 t": null,
    "TFA 18:2 t not further defined": null,
    "Fatty acids, total trans": 0,
    "Fatty acids, total trans-monoenoic": null,
    "Fatty acids, total trans-polyenoic": null
  };
  const apiKey = "CG2yX4SYvLy4rHv2aUu5nsuUgCIMNJdRPpdOS6Jj"; // tu API Key
  document.getElementById("search").addEventListener("input", async function() {
    const texto = this.value.trim();
    const contenedor = document.getElementById("sugerencias");
    contenedor.innerHTML = "";
    if (texto.length < 3) return;
    
    const res = await fetch(`https://api.nal.usda.gov/fdc/v1/foods/search?query=${encodeURIComponent(texto)}&pageSize=500&pageNumber=1&api_key=${apiKey}`);
    const data = await res.json();
    
    const alimentos = data.foods?.filter(f => f.dataType === "Foundation" || f.dataType === "SR Legacy");
    if (!alimentos?.length) return;
    
    alimentos.forEach(alimento => {
      const div = document.createElement("div");
      div.innerHTML = `<img src="https://flagcdn.com/us.svg" alt="US Flag"/> ${alimento.description}`;
      div.onclick = () => {
        document.getElementById("search").value = alimento.description;
        contenedor.innerHTML = "";
        buscar(); // Ejecuta búsqueda directamente
      };
      contenedor.appendChild(div);
    });
  });
  const alimentosSeleccionados = [];
  const nutrientesTotales = new Map();
  
  const traduccionesNutrientes = {
    
    // Totales
    
    
    // Macronutrientes
    "Energy (kcal)": "Energía (kcal)",
    "Energy (kJ)": "Energía (kJ)",
    "Protein": "Proteínas",
    "Carbohydrate, by difference": "Carbohidratos",
    "Water": "Agua",
    "Alcohol, ethyl": "Alcohol etílico",
    "Phytosterols": "Fitosteroles",
    "Cholesterol": "Colesterol",
    "Starch": "Almidón",
    "Caffeine": "Cafeína",
    "Theobromine": "Teobromina",
    "Fiber, total dietary": "Fibra total dietética",
    "Total lipid (fat)": "Grasa total Lípidos",
    
    // Minerales
    "Calcium, Ca": "Calcio (Ca)",
    "Phosphorus, P": "Fósforo (P)",
    "Magnesium, Mg": "Magnesio (Mg)",
    "Sodium, Na": "Sodio (Na)",
    "Potassium, K": "Potasio (K)",
    "Chloride": "Cloruro",
    "Iron, Fe": "Hierro (Fe)",
    "Zinc, Zn": "Zinc (Zn)",
    "Copper, Cu": "Cobre (Cu)",
    "Manganese, Mn": "Manganeso (Mn)",
    "Selenium, Se": "Selenio (Se)",
    "Chromium, Cr": "Cromo (Cr)",
    "Iodine, I": "Yodo (I)",
    "Molybdenum, Mo": "Molibdeno (Mo)",
    "Fluoride, F": "Flúor",
    "Ash": "Cenizas",
    
    // Vitaminas liposolubles
    "Vitamin A": "Vitamina A",
    "Vitamin A, RAE": "Vitamina A (RAE)",
    "Vitamin A, IU": "Vitamina A, UI",
    "Retinol": "Retinol",
    "Carotene, beta": "Betacaroteno",
    "Carotene, alpha": "Alfacaroteno",
    "Lycopene": "Licopeno",
    "Vitamin D (D2 + D3)": "Vitamina D (D2 + D3)",
    "Vitamin D3 (cholecalciferol)": "Vitamina D3 (colecalciferol)",
    "Vitamin D (D2 + D3), International Units": "Vitamina D (D2 + D3), Unidades Internacionales",
    "Vitamin E (alpha-tocopherol)": "Vitamina E (alfa-tocoferol)",
    "Tocopherol, beta": "Vit. E Tocoferol beta",
    "Tocopherol, gamma": "Vit. E Tocoferol gamma",
    "Tocopherol, delta": "Vit. E Tocoferol delta",
    "Tocotrienol, alpha": "Vit. E Tocotrienol alfa",
    "Tocotrienol, beta": "Vit. E Tocotrienol beta",
    "Tocotrienol, gamma": "Vit. E Tocotrienol gamma",
    "Tocotrienol, delta": "Vit. E Tocotrienol delta",
    "Vitamin E, added": "Vitamina E añadida",
    "Vitamin K (phylloquinone)": "Vitamina K (filoquinona)",
    "Vitamin K (Dihydrophylloquinone)": "Vitamina K (dihidrofiloquinona)",
    "Vitamin K (Menaquinone-4)": "Vitamina K 4",
    "Cryptoxanthin, beta": "Criptoxantina beta",
    "Lutein + zeaxanthin": "Lutein + zeaxanthin",
    
    
    // Vitaminas hidrosolubles
    "Vitamin C, total ascorbic acid": "Vitamina C",
    "Thiamin": "Tiamina B1",
    "Riboflavin": "Riboflavina B2",
    "Niacin": "Niacina B3",
    "Vitamin B-6": "Vitamina B6",
    "Folate, total": "Folato total",
    "Folic acid": "Ácido fólico",
    "Folate, food": "Folato A",
    "Folate, DFE": "Folato D",
    "Vitamin B-12": "Vitamina B12",
    "Vitamin B-12, added": "Vitamina B12 añadida",
    "Biotin": "Biotina B7",
    "Pantothenic acid": "Ácido Pantoténico B5",
    "Choline, total": "Colina",
    "Betaine": "Betaína",
    
    // Azúcares simples
    "Sucrose": "Sacarosa",
    "Glucose": "Glucosa",
    "Fructose": "Fructosa",
    "Lactose": "Lactosa",
    "Maltose": "Maltosa",
    "Galactose": "Galactosa",
    "Total sugar alcohols": "Alcoholes de azúcar totales",
    "Sugars, added": "Azúcares añadidos",
    "Total Sugars": "Azúcares totales",
    
    // Aminoácidos esenciales
    "Histidine": "Histidina",
    "Isoleucine": "Isoleucina",
    "Leucine": "Leucina",
    "Lysine": "Lisina",
    "Methionine": "Metionina",
    "Phenylalanine": "Fenilalanina",
    "Threonine": "Treonina",
    "Tryptophan": "Triptófano",
    "Valine": "Valina",
    
    // Aminoácidos no esenciales
    "Alanine": "Alanina",
    "Arginine": "Arginina",
    "Aspartic acid": "Ácido aspártico",
    "Cysteine": "Cisteína",
    "Glutamic acid": "Ácido glutámico",
    "Glutamine": "Glutamina",
    "Glycine": "Glicina",
    "Ornithine": "Ornitina",
    "Proline": "Prolina",
    "Serine": "Serina",
    "Tyrosine": "Tirosina",
    "Citrulline": "Citrulina",
    
    // Grasas saturadas
    "SFA 4:0": "Ác. Butírico",
    "SFA 6:0": "Ác. Caproico",
    "SFA 8:0": "Ác. Caprílico",
    "SFA 10:0": "Ác. Cáprico",
    "SFA 12:0": "Ác. Láurico",
    "SFA 14:0": "Ác. Mirístico",
    "SFA 13:0": "Ác. Tridecanoico",
    "SFA 15:0": "Ác. Pentadecanoico",
    "SFA 16:0": "Ác. Palmítico",
    "SFA 17:0": "Ác. Heptadecanoico",
    "SFA 18:0": "Ác. Esteárico",
    "SFA 20:0": "Ác. Araquídico",
    "SFA 22:0": "Ácido Behénico",
    "SFA 24:0": "Ác. Lignocérico",
    "Fatty acids, total saturated": "totales Saturados",
    
    
    // Grasas monoinsaturadas
    "MUFA 14:1": "Ác. Miristoleico",
    "MUFA 15:1": "Ác. Pentadecenoico",
    "MUFA 16:1": "Ác. Palmitoleico",
    "MUFA 16:1 c": "Ác. Palmitoleico C",
    "MUFA 17:1": "Ác. Heptadecenoico",
    "MUFA 18:1": "Ác. Oleico",
    "MUFA 18:1 c": "Ác. Oleico C",
    "MUFA 20:1": "Ác. Eicosenoico",
    "MUFA 22:1": "Ác. Erúcico",
    "MUFA 22:1 c": "Ác. Erúcico C",
    "MUFA 24:1 c": "Ác. Nervónico",
    "Fatty acids, total monounsaturated": "totales Monoinsaturados",
    
    // Grasas poliinsaturadas
    "PUFA 18:2": "Ác. Linoleico",
    "PUFA 18:2 n-6 c,c": "Ác. Linoleico C",
    "PUFA 18:2 CLAs": "Ác. Linoleicos C",
    "PUFA 18:3": "Ác. Alfa Linoléico",
    "PUFA 18:3 n-3 c,c,c (ALA)": "Ác. Alfa Linolénico",
    "PUFA 18:3 n-6 c,c,c": "Ác. Gamma Linoléico",
    "PUFA 18:4": "Ác. Estearidónico",
    "PUFA 20:2 n-6 c,c": "Ác. Eicosadieno",
    "PUFA 20:3": "Ác. Eicosatrienoico",
    "PUFA 20:3 n-3": "Ác. Eicosatrienoico N",
    "PUFA 20:3 n-6": "Ác. Dihomo D",
    "PUFA 20:4": "Ác. Araquidónico",
    "PUFA 20:5 n-3 (EPA)": " Ác. Eicosapentaenoico",
    "PUFA 22:4": "Ác. Adrenico",
    "PUFA 22:5 n-3 (DPA)": "Ác. Docosapentaenoico",
    "PUFA 22:6 n-3 (DHA)": "Ác. Docosahexaenoico",
    "Fatty acids, total polyunsaturated": "totales Poliinsaturados",
    
    // Grasas trans
    "TFA 16:1 t": "Ácido Palmitoleico",
    "TFA 18:1 t": "Ácido Elaídico",
    "TFA 22:1 t": "Ácido Erúcico",
    "TFA 18:2 t not further defined": "Ácido Linoelaídico",
    
    "Fatty acids, total trans": "Ácidos grasos trans totales",
    "Fatty acids, total trans-monoenoic": "Ácidos Monoinsaturados",
    "Fatty acids, total trans-polyenoic": "Ácidos Poliinsaturados",
    
    // Grupos generales (encabezados)
    "Carbohydrates": "Carbohidratos",
    "Proximates": "Proximales",
    "Lipids": "Lípidos",
    "Amino acids": "Aminoácidos",
    "Minerals": "Minerales",
    "Vitamins and Other Components": "Vitaminas y Otros Componentes",
    "Units": "Unidades"
  };
  
  const categories = {
    "Macronutrientes + bioactivos": [
      "Energy (kcal)",
      "Energy (kJ)",
      "Protein",
      "Carbohydrate, by difference",
      "Starch",
      "Cholesterol",
      "Caffeine",
      "Theobromine",
      "Phytosterols",
      "Water",
      "Alcohol, ethyl",
      "Total lipid (fat)",
      "Fiber, total dietary"
    ],
    "Minerales": [
      "Ash",
      "Calcium, Ca",
      "Phosphorus, P",
      "Magnesium, Mg",
      "Sodium, Na",
      "Potassium, K",
      "Chloride",
      "Iron, Fe",
      "Zinc, Zn",
      "Copper, Cu",
      "Manganese, Mn",
      "Selenium, Se",
      "Chromium, Cr",
      "Iodine, I",
      "Molybdenum, Mo",
      "Fluoride, F"
    ],
    "Vitaminas liposolubles": [
      "Vitamin A, IU",
      "Vitamin A, RAE",
      "Retinol",
      "Carotene, beta",
      "Carotene, alpha",
      "Lycopene",
      "Vitamin D (D2 + D3), International Units",
      "Vitamin D (D2 + D3)",
      "Vitamin D3 (cholecalciferol)",
      "Vitamin E (alpha-tocopherol)",
      "Vitamin E, added",
      "Tocopherol, beta",
      "Tocopherol, gamma",
      "Tocopherol, delta",
      "Tocotrienol, alpha",
      "Tocotrienol, beta",
      "Tocotrienol, gamma",
      "Tocotrienol, delta",
      "Vitamin K (phylloquinone)",
      "Vitamin K (Menaquinone-4)",
      "Cryptoxanthin, beta",
      "Lutein + zeaxanthin"
    ],
    "Vitaminas hidrosolubles": [
      "Vitamin C, total ascorbic acid",
      "Thiamin",
      "Riboflavin",
      "Niacin",
      "Vitamin B-6",
      "Folate, total",
      "Folic acid",
      "Folate, food",
      "Folate, DFE",
      "Vitamin B-12",
      "Vitamin B-12, added",
      "Biotin",
      "Pantothenic acid",
      "Choline, total",
      "Betaine"
    ],
    "Azúcares simples": [
      "Sucrose",
      "Glucose",
      "Fructose",
      "Lactose",
      "Maltose",
      "Galactose",
      "Total Sugars"
    ],
    "Aminoácidos esenciales": [
      "Histidine",
      "Isoleucine",
      "Leucine",
      "Lysine",
      "Methionine",
      "Phenylalanine",
      "Threonine",
      "Tryptophan",
      "Valine"
    ],
    "Aminoácidos no esenciales": [
      "Alanine",
      "Arginine",
      "Aspartic acid",
      "Cysteine",
      "Glutamic acid",
      "Glutamine",
      "Glycine",
      "Ornithine",
      "Proline",
      "Serine",
      "Tyrosine",
      "Citrulline"
    ],
    "Grasas saturadas": [
      "SFA 4:0",
      "SFA 6:0",
      "SFA 8:0",
      "SFA 10:0",
      "SFA 12:0",
      "SFA 14:0",
      "SFA 15:0",
      "SFA 16:0",
      "SFA 17:0",
      "SFA 18:0",
      "SFA 20:0",
      "SFA 22:0",
      "SFA 24:0",
      "Fatty acids, total saturated"
    ],
    "Grasas monoinsaturadas": [
      "MUFA 14:1",
      "MUFA 15:1",
      "MUFA 16:1",
      "MUFA 16:1 c",
      "MUFA 17:1",
      "MUFA 18:1",
      "MUFA 18:1 c",
      "MUFA 20:1",
      "MUFA 22:1",
      "MUFA 22:1 c",
      "MUFA 24:1 c",
      "Fatty acids, total monounsaturated"
    ],
    "Grasas poliinsaturadas": [
      "PUFA 18:2",
      "PUFA 18:2 n-6 c,c",
      "PUFA 18:2 CLAs",
      "PUFA 18:3",
      "PUFA 18:3 n-3 c,c,c (ALA)",
      "PUFA 18:3 n-6 c,c,c",
      "PUFA 18:4",
      "PUFA 20:2 n-6 c,c",
      "PUFA 20:3", "PUFA 20:3 n-3",
      "PUFA 20:3 n-6",
      "PUFA 20:4",
      "PUFA 20:5 n-3 (EPA)",
      "PUFA 22:4",
      "PUFA 22:5 n-3 (DPA)",
      "PUFA 22:6 n-3 (DHA)",
      "Fatty acids, total polyunsaturated",
      
    ],
    "Grasas trans": [
      "TFA 16:1 t",
      "TFA 18:1 t",
      "TFA 22:1 t",
      "TFA 18:2 t not further defined",
      "Fatty acids, total trans",
      "Fatty acids, total trans-monoenoic",
      "Fatty acids, total trans-polyenoic"
    ],
    "Grupos generales (encabezados)b": [
      "Carbohydrates",
      "Proximates",
      "Lipids",
      "Amino acids",
      "Minerals",
      "Vitamins and Other Components",
      "Units"
    ]
  };
  
  async function buscar() {
    const query = document.getElementById("search").value.trim();
    const gramos = parseFloat(document.getElementById("grams").value);
    if (!query) return;
    
    document.getElementById("resultados").innerText = "Searching...";
    const res = await fetch(`https://api.nal.usda.gov/fdc/v1/foods/search?query=${encodeURIComponent(query)}&pageSize=500&pageNumber=1&api_key=${apiKey}`);
    const data = await res.json();
    
    const alimentos = data.foods?.filter(f => f.dataType === "Foundation" || f.dataType === "SR Legacy");
    if (!alimentos?.length) {
      document.getElementById("resultados").innerText = "No food with complete profile found.";
      return;
    }
    
    const food = alimentos[0];
    const foodDetail = await fetch(`https://api.nal.usda.gov/fdc/v1/food/${food.fdcId}?api_key=${apiKey}`);
    const detalle = await foodDetail.json();
    
    alimentosSeleccionados.push({
      nombre: `${food.description} (${gramos}g)`,
      gramos: gramos,
      nutrientes: detalle.foodNutrients
    });
    document.getElementById("resultados").innerText = `Agregado: ${food.description}`;
    actualizarListaAlimentos(); // <--- usar esto en lugar de modificar innerHTML directamente
    
    detalle.foodNutrients.forEach(n => {
      if (!n.nutrient || !n.nutrient.name) return;
      let name = n.nutrient.name;
      if (name === "Energy") name += ` (${n.nutrient.unitName})`;
      const valor = n.amount ? (n.amount * gramos / 100) : 0;
      if (!nutrientesTotales.has(name)) {
        nutrientesTotales.set(name, { value: 0, unit: n.nutrient.unitName });
      }
      nutrientesTotales.get(name).value += valor;
    });
    
    actualizarTabla();
  }
  
function actualizarTabla() {
  const tbody = document.querySelector("#tabla tbody");
  tbody.innerHTML = "";
  
  const ignorados = categories["Grupos generales (encabezados)b"];
  
  for (const [cat, nutrientes] of Object.entries(categories)) {
    let hayDatos = nutrientes.some(n => nutrientesTotales.has(n) && !ignorados.includes(n));
    if (!hayDatos) continue;
    
    tbody.insertAdjacentHTML("beforeend", `<tr class="category"><td colspan="4">${cat}</td></tr>`);
    
    nutrientes.forEach(n => {
      if (ignorados.includes(n)) return;
      const info = nutrientesTotales.get(n);
      if (info) {
        const convertido = convertirUnidad(info.value, info.unit);
        const vdr = calcularVDR(n, convertido.valor);
        const nombreTraducido = traduccionesNutrientes[n] || n;
        tbody.insertAdjacentHTML("beforeend",
          `<tr><td>${nombreTraducido}</td><td>${convertido.valor.toFixed(3)}</td><td>${convertido.unidad}</td><td>${vdr.toFixed(1)}%</td></tr>`);
      }
    });
  }
}
  
  function copiarResultados() {
  const ignorarGrupo = [
  "Carbohydrates",
  "Proximates",
  "Lipids",
  "Amino acids",
  "Minerals",
  "Vitamins and Other Components",
  "Units"
  ];
  
  let texto = "Hace un análisis riguroso de la lista de los nutrientes y decime si todos los valores son correctos con tilde, cruz en colores y sin tablas.\n";
  texto += "Alimentos seleccionados mas valores sumados:\n" + alimentosSeleccionados.map(a => a.nombre).join(", ") + "\n\nTotales:\n";
  texto += "Nutriente\tCantidad\tUnidad\n";
  
  for (const [nombre, dato] of nutrientesTotales.entries()) {
    if (ignorarGrupo.includes(nombre)) continue;
    texto += `${nombre}\t${dato.value.toFixed(3)}\t${dato.unit}\n`;
  }
  
  navigator.clipboard.writeText(texto);
  alert("Resultados copiados al portapapeles");
}
  
  function limpiarTodo() {
    alimentosSeleccionados.length = 0;
    nutrientesTotales.clear();
    document.getElementById("tabla").querySelector("tbody").innerHTML = "";
    document.getElementById("listaAlimentos").innerHTML = "";
    document.getElementById("resultados").innerText = "";
  }
  
  function calcularVDR(nombre, valor) {
    const referencia = valoresDiarios[nombre];
    if (!referencia) return 0;
    return (valor / referencia) * 100;
  }
  
  function actualizarListaAlimentos() {
    const lista = document.getElementById("listaAlimentos");
    lista.innerHTML = "";
    alimentosSeleccionados.forEach((a, i) => {
      const li = document.createElement("li");
      li.innerHTML = `${a.nombre} <button onclick="eliminarAlimento(${i})">Eliminar</button>`;
      lista.appendChild(li);
    });
  }
  
  function eliminarAlimento(index) {
    const alimento = alimentosSeleccionados[index];
    if (!alimento) return;
    
    // Restar nutrientes
    alimento.nutrientes.forEach(n => {
      if (!n.nutrient || !n.nutrient.name) return;
      let name = n.nutrient.name;
      if (name === "Energy") name += ` (${n.nutrient.unitName})`;
      const valor = n.amount ? (n.amount * alimento.gramos / 100) : 0;
      if (nutrientesTotales.has(name)) {
        nutrientesTotales.get(name).value -= valor;
        if (nutrientesTotales.get(name).value <= 0) {
          nutrientesTotales.delete(name);
        }
      }
    });
    
    alimentosSeleccionados.splice(index, 1);
    actualizarListaAlimentos(); // <-- esta línea faltaba
    actualizarTabla();
  }
  
  function convertirUnidad(valor, unidad) {
    // Normalizamos por si viene en mayúsculas
    const u = unidad.toUpperCase();
    
    switch (u) {
      case "UG": // microgramos
        if (valor >= 1000) return { valor: valor / 1000, unidad: "mg" };
        return { valor, unidad: "µg" };
        
      case "MG": // miligramos
        if (valor >= 1000) return { valor: valor / 1000, unidad: "g" };
        return { valor, unidad: "mg" };
        
      case "G": // gramos
        return { valor, unidad: "g" };
        
      case "KG": // kilogramos
        return { valor, unidad: "kg" };
        
      case "KCAL": // kilocalorías
        return { valor, unidad: "kcal" };
        
      case "KJ": // kilojulios
        return { valor, unidad: "kJ" };
        
      case "IU": // unidades internacionales
        return { valor, unidad: "IU" };
        
      case "ML": // mililitros
        return { valor, unidad: "ml" };
        
      case "L": // litros
        return { valor, unidad: "l" };
        
      case "OZ": // onzas
        return { valor, unidad: "oz" };
        
      case "LB": // libras
        return { valor, unidad: "lb" };
        
      case "MG_NA_EQ": // equivalentes de sodio (muy raro)
        return { valor, unidad: "mg Na eq" };
        
      default:
        // Si no se reconoce, devolvemos la unidad original
        return { valor, unidad: unidad };
    }
  }
</script>

</body>

</html>
